doctype xml

Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  Styles
    Style ss:ID="s1"
      Font ss:Bold="1"
    Style ss:ID="s2"
      NumberFormat ss:Format="mm/dd/yyyy"
  Worksheet ss:Name=I18n.t("exports.pdf.title.#{controller_name.underscore}")

    Table
      Column ss:Width="200"
      Column ss:Width="400"
      Column ss:Width="100"
      Column ss:Width="100"
      Column ss:Width="100"
      Row ss:StyleID="s1"
        Cell
          Data ss:Type="String" NAME
        Cell
          Data ss:Type="String" DESCRIPTION
        Cell
          Data ss:Type="String" FIRST EVENT
        Cell
          Data ss:Type="String" LAST EVENT
        Cell
          Data ss:Type="String" ACTIVE STATE

      - each_collection_item do |campaign|
        Row
          Cell
            Data ss:Type="String"= campaign.name
          Cell
            Data ss:Type="String"= campaign.description
          - if campaign.first_event_at.present?
            Cell ss:StyleID="s2"
              Data ss:Type="DateTime"= Timeliness.parse(campaign.first_event_at.strftime('%Y-%m-%d %H:%M:%S'), zone: 'UTC').strftime('%FT%R')
          - else
            Cell
              Data ss:Type="String"
          - if campaign.last_event_at.present?
            Cell ss:StyleID="s2"
              Data ss:Type="DateTime"= Timeliness.parse(campaign.last_event_at.strftime('%Y-%m-%d %H:%M:%S'), zone: 'UTC').strftime('%FT%R')
          - else
            Cell
              Data ss:Type="String"
          Cell
            Data ss:Type="String"= campaign.status